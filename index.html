<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Breach: The Game</title>
  <style>
    body { font-family: sans-serif; background-color: #f9f9f9; padding: 20px; }
    button { margin: 5px; padding: 10px 20px; font-size: 16px; }
    #game-area { position: relative; width: 960px; height: 540px; border: 1px solid #ccc; margin-bottom: 20px; }
    #background { width: 100%; height: 100%; }
    #character { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); height: 60%; pointer-events: none; }
    #dialogue-box { background: rgba(255,255,255,0.95); padding: 15px; border: 1px solid #ccc; max-width: 960px; min-height: 100px; margin-bottom: 10px; }
    #options-box button { display: block; margin-top: 5px; }
      #dialogue-box {
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border: 2px solid #444;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
      line-height: 1.5;
    }
    #options-box button {
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
      font-size: 15px;
      width: 100%;
      max-width: 400px;
      margin: 10px auto;
      display: block;
      cursor: pointer;
    }
    #options-box button:hover {
      background-color: #f0f0f0;
    }

    #clue-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border: 2px solid #444;
      padding: 20px;
      max-width: 400px;
      z-index: 1000;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    #clue-popup ul {
      padding-left: 20px;
    }
    #clue-popup h3 {
      margin-top: 0;
    }
    #clue-popup button {
      margin-top: 15px;
    }
  </style>
</head>
</head>
<body>
  <h1>The Breach: The Game</h1>
  <div>
    <button onclick="navigateTo('Main Office')">Main Office</button>
    <button onclick="navigateTo('Break Room')">Break Room</button>
    <button onclick="navigateTo('HR Office')">HR Office</button>
    <button onclick="navigateTo('Crutchfield\'s Office')">Crutchfield's Office</button>
    <button onclick="navigateTo('Lobby')">Lobby</button>
    <button onclick="navigateTo('Server Room')">Server Room</button>
    <button onclick="toggleCluePopup()">View Clue Sheet</button>
  </div>

  <div id="game-area">
    <img id="background" src="" alt="Room Background">
    <img id="character" src="" alt="Character">
  </div>

<div id="clue-popup">
  <h3>Clue Sheet</h3>
  <ul id="clue-list"></ul>
  <button onclick="toggleCluePopup()">Close</button>
</div>

<div id="dialogue-box">Click a room to begin your investigation.</div>
  <div id="options-box"></div>

  <script>
    const state = {
      talkedToCoyle: false,
      unlockedCoyleInsight: false,
      talkedToReyes: false,
      unlockedReyesInsight: false,
      talkedToCrutchfield: false,
      unlockedCrutchfieldInsight: false,
      talkedToCorey: false,
      clueSheet: [],
      clueFound: false,
      talkedToLogan: false,
      unlockedLoganConfession: false,
    };

    let currentRoom = "";

    function logDialogue(text) {
      document.getElementById("dialogue-box").innerText = text;
    }

    function clearOptions() {
      document.getElementById("options-box").innerHTML = "";
    }

    function addOption(label, callback) {
      const btn = document.createElement("button");
      btn.textContent = label;
      btn.onclick = callback;
      document.getElementById("options-box").appendChild(btn);
    }

    function addClue(clue) {
      if (!state.clueSheet.includes(clue)) {
        state.clueSheet.push(clue);
        logDialogue(`📝 Clue added to sheet: ${clue}`);
      }
    }

    function toggleCluePopup() {
  const popup = document.getElementById("clue-popup");
  const list = document.getElementById("clue-list");
  if (popup.style.display === "none" || popup.style.display === "") {
    list.innerHTML = "";
    if (state.clueSheet.length === 0) {
      const li = document.createElement("li");
      li.textContent = "No clues yet.";
      list.appendChild(li);
    } else {
      state.clueSheet.forEach((clue, i) => {
        const li = document.createElement("li");
        li.textContent = `${i + 1}. ${clue}`;
        list.appendChild(li);
      });
    }
    popup.style.display = "block";
  } else {
    popup.style.display = "none";
  }

    }

    function highlightRoomButton(room) {
      document.querySelectorAll("button").forEach(btn => {
        if (btn.textContent.includes(room)) {
          btn.style.backgroundColor = "#d0eaff";
        } else if (btn.textContent.includes("Room")) {
          btn.style.backgroundColor = "";
        }
      });
    }

    function navigateTo(room) {
      const bg = document.getElementById("background");
      const char = document.getElementById("character");
      clearOptions();
      currentRoom = room;
      highlightRoomButton(room);
      switch (room) {
        case "Server Room":
          bg.src = "assets/rooms/server_room.png";
          char.src = "assets/characters/coyle.png";
          logDialogue("Agent Coyle stands beside a humming server rack, looking thoughtful.");
          addOption("Talk to Coyle", talkToCoyle);
          break;
        case "Lobby":
          bg.src = "assets/rooms/lobby.png";
          char.src = "assets/characters/reyes.png";
          logDialogue("Agent Reyes leans against the reception desk, watching you approach.");
          addOption("Talk to Reyes", talkToReyes);
          break;
        case "Main Office":
          bg.src = "assets/rooms/main_office.png";
          char.src = "assets/characters/logan.png";
          logDialogue("You see Logan at his desk, visibly nervous.");
          addOption("Talk to Logan", talkToLogan);
          break;
        case "Break Room":
  bg.src = "assets/rooms/break_room.png";
  char.src = "";
  logDialogue("A quiet room. You notice a USB drive on the table.");
  addOption("View USB Drive", () => {
    addClue("Secret Drive labeled for Agent Coyle");
    logDialogue("You inspect the USB. It's labeled 'Secret Drive for Agent Coyle' and appears to have logs from a secure source.");
  });
          break;
        case "HR Office":
          bg.src = "assets/rooms/hr_office.png";
          char.src = "assets/characters/corey.png";
          logDialogue("You find Corey examining some personnel files.");
          addOption("Talk to Corey", talkToCorey);
          break;
        case "Crutchfield's Office":
          bg.src = "assets/rooms/crutchfield_office.png";
          char.src = "assets/characters/crutchfield.png";
          logDialogue("Deputy Director Crutchfield stands at her desk, reviewing a report.");
          addOption("Talk to Crutchfield", talkToCrutchfield);
          break;
        default:
          logDialogue("This room doesn't exist yet.");
          break;
      }
    }

    function talkToLogan() {
  clearOptions();
  if (!state.loganDialogues) {
    state.loganDialogues = {
      onboarding: false,
      aftermath: false,
      feelings: false,
      backgroundCheck: false
    };
  }
  logDialogue("Logan: 'Am I in trouble? I thought I followed protocol.'");

  if (!state.loganDialogues.onboarding) {
    addOption("Ask about the onboarding email", () => {
      clearOptions();
      logDialogue("Logan: 'It looked official... I just clicked the link without thinking. I'm sorry.'");
      addClue("Logan admits to clicking the phishing email.");
      state.loganDialogues.onboarding = true;
    });
  }

  if (!state.loganDialogues.aftermath) {
    addOption("Ask what happened after he clicked", () => {
      clearOptions();
      logDialogue("Logan: 'It froze for a second, then nothing. I didn’t even realize it was a problem until now.'");
      state.loganDialogues.aftermath = true;
    });
  }

  if (!state.loganDialogues.feelings) {
    addOption("Ask how he feels about the breach", () => {
      clearOptions();
      logDialogue("Logan: 'Honestly? I feel awful. I just wanted to start strong here. This isn’t the impression I wanted to make.'");
      state.loganDialogues.feelings = true;
    });
  }

  if (!state.loganDialogues.backgroundCheck) {
    addOption("Ask if he had cybersecurity training before this job", () => {
      clearOptions();
      logDialogue("Logan: 'Yeah, but it was super basic. Nothing about spear phishing or anything that realistic.'");
      state.loganDialogues.backgroundCheck = true;
    });
  }

  if (state.loganDialogues.onboarding && state.loganDialogues.aftermath && state.loganDialogues.feelings && state.loganDialogues.backgroundCheck) {
    logDialogue("Logan: 'I just hope this doesn’t ruin everything.'");
  }

}

function talkToCorey() {
  clearOptions();
  if (!state.coreyDialogues) {
    state.coreyDialogues = {
      behavior: false,
      pastIncidents: false,
      phishingTips: false,
      clickedBefore: false
    };
  }
  logDialogue("Corey: 'This isn’t my first breach rodeo. What do you need?'");
  if (!state.coreyDialogues.behavior) {
    addOption("Ask about any suspicious behavior", () => {
      clearOptions();
      logDialogue("Corey: 'Logan came to me about an email that looked weird. I told him not to open it, but who listens to me?'");
      addClue("Corey warned Logan not to open the suspicious email.");
      state.coreyDialogues.behavior = true;
      addOption("Ask why he didn’t report it to IT", () => {
        clearOptions();
        logDialogue("Corey: 'Honestly? I figured he'd be fine. Kid seemed sharp.'");
      });
    });
  }
  if (!state.coreyDialogues.pastIncidents) {
    addOption("Ask about past incidents", () => {
      clearOptions();
      logDialogue("Corey: 'HR has had issues with spoofed onboarding emails before. Should've flagged that one faster.'");
      state.coreyDialogues.pastIncidents = true;
      addOption("Ask who handled those past incidents", () => {
        clearOptions();
        logDialogue("Corey: 'Usually Reyes and I. But this time, she was out for the day.'");
      });
    });
  }
  if (!state.coreyDialogues.phishingTips) {
    addOption("Ask how he’d recognize phishing", () => {
      clearOptions();
      logDialogue("Corey: 'URLs are your friend. If it looks sketchy, it probably is. Want me to run a check next time?'");
      state.coreyDialogues.phishingTips = true;
      addOption("Ask what makes a URL suspicious", () => {
        clearOptions();
        logDialogue("Corey: 'Typos, extra characters, weird domains like .ru instead of .com. Stuff like that.'");
      });
    });
  }
  if (!state.coreyDialogues.clickedBefore) {
    addOption("Ask if he’s ever clicked something bad", () => {
      clearOptions();
      logDialogue("Corey: 'Not since my black hat days. But we all slip up now and then, right?'");
      state.coreyDialogues.clickedBefore = true;
      addOption("Press him on that comment", () => {
        clearOptions();
        logDialogue("Corey: 'Relax, I’m clean now. I use my powers for good. Just trying to help the team.'");
      });
    });
  }
  if (state.coreyDialogues.behavior && state.coreyDialogues.pastIncidents && state.coreyDialogues.phishingTips && state.coreyDialogues.clickedBefore) {
    logDialogue("Corey: 'That’s all I’ve got for now. Hope it helps.'");
  }
}

function talkToCrutchfield() {
  clearOptions();
  if (!state.crutchfieldDialogues) {
    state.crutchfieldDialogues = {
      onboarding: false,
      response: false,
      suspicion: false
    };
  }
  logDialogue("Crutchfield: 'I expected better. This kind of lapse could cost us dearly.'");

  if (!state.crutchfieldDialogues.onboarding) {
    addOption("Ask about Logan's onboarding process", () => {
      clearOptions();
      logDialogue("Crutchfield: 'I delegated it to HR, but I did review the checklist. He should have had phishing training.'");
      addClue("Crutchfield claims Logan was trained to spot phishing emails.");
      state.crutchfieldDialogues.onboarding = true;
    });
  }
  if (!state.crutchfieldDialogues.response) {
    addOption("Ask about department response time", () => {
      clearOptions();
      logDialogue("Crutchfield: 'We responded within protocol, but the payload executed fast. We’ll need new safeguards.'");
      state.crutchfieldDialogues.response = true;
    });
  }
  if (!state.crutchfieldDialogues.suspicion) {
    addOption("Ask if anyone else was suspicious", () => {
      clearOptions();
      logDialogue("Crutchfield: 'Corey always toes the line. Sometimes too closely, if you ask me.'");
      state.crutchfieldDialogues.suspicion = true;
    });
  }

  if (state.crutchfieldDialogues.onboarding && state.crutchfieldDialogues.response && state.crutchfieldDialogues.suspicion) {
    logDialogue("Crutchfield: 'Get me results soon. I want this cleaned up before it spreads further.'");
  }
}}





function startGame() {
      navigateTo("Lobby");
    }

    window.onload = startGame;

  </script>
</body>
</html>
