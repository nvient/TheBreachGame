<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Breach: The Game</title>
  <style>
    body { font-family: sans-serif; background-color: #f9f9f9; padding: 20px; }
    button { margin: 5px; padding: 10px 20px; font-size: 16px; }
    #game-area { position: relative; width: 960px; height: 540px; border: 1px solid #ccc; margin-bottom: 20px; }
    #background { width: 100%; height: 100%; }
    #character { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); height: 60%; pointer-events: none; }
    #dialogue-box { background: rgba(255,255,255,0.95); padding: 15px; border: 1px solid #ccc; max-width: 960px; min-height: 100px; margin-bottom: 10px; }
    #options-box button { display: block; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>The Breach: The Game</h1>
  <div>
    <button onclick="navigateTo('Main Office')">Main Office</button>
    <button onclick="navigateTo('Break Room')">Break Room</button>
    <button onclick="navigateTo('HR Office')">HR Office</button>
    <button onclick="navigateTo('Crutchfield\'s Office')">Crutchfield's Office</button>
    <button onclick="navigateTo('Lobby')">Lobby</button>
    <button onclick="navigateTo('Server Room')">Server Room</button>
    <button onclick="toggleCluePopup()">View Clue Sheet</button>
  </div>

  <div id="game-area">
    <img id="background" src="" alt="Room Background">
    <img id="character" src="" alt="Character">
  </div>

  <div id="dialogue-box">Click a room to begin your investigation.</div>
  <div id="options-box"></div>

  <script>
    const state = {
      talkedToCoyle: false,
      unlockedCoyleInsight: false,
      talkedToReyes: false,
      unlockedReyesInsight: false,
      talkedToCrutchfield: false,
      unlockedCrutchfieldInsight: false,
      talkedToCorey: false,
      clueSheet: [],
      clueFound: false,
      talkedToLogan: false,
      unlockedLoganConfession: false,
    };

    let currentRoom = "";

    function logDialogue(text) {
      document.getElementById("dialogue-box").innerText = text;
    }

    function clearOptions() {
      document.getElementById("options-box").innerHTML = "";
    }

    function addOption(label, callback) {
      const btn = document.createElement("button");
      btn.textContent = label;
      btn.onclick = callback;
      document.getElementById("options-box").appendChild(btn);
    }

    function addClue(clue) {
      if (!state.clueSheet.includes(clue)) {
        state.clueSheet.push(clue);
        logDialogue(`📝 Clue added to sheet: ${clue}`);
      }
    }

    function viewClueSheet() {
      const clues = state.clueSheet.map((c, i) => `${i + 1}. ${c}`).join("\n");
      logDialogue("📋 Clue Sheet:\n" + (clues || "No clues yet."));
      clearOptions();
    }

    function highlightRoomButton(room) {
      document.querySelectorAll("button").forEach(btn => {
        if (btn.textContent.includes(room)) {
          btn.style.backgroundColor = "#d0eaff";
        } else if (btn.textContent.includes("Room")) {
          btn.style.backgroundColor = "";
        }
      });
    }

    function navigateTo(room) {
      const bg = document.getElementById("background");
      const char = document.getElementById("character");
      clearOptions();
      currentRoom = room;
      highlightRoomButton(room);
      switch (room) {
        case "Server Room":
          bg.src = "assets/rooms/server_room.png";
          char.src = "assets/characters/coyle.png";
          logDialogue("Agent Coyle stands beside a humming server rack, looking thoughtful.");
          addOption("Talk to Coyle", talkToCoyle);
          break;
        case "Lobby":
          bg.src = "assets/rooms/lobby.png";
          char.src = "assets/characters/reyes.png";
          logDialogue("Agent Reyes leans against the reception desk, watching you approach.");
          addOption("Talk to Reyes", talkToReyes);
          break;
        case "Main Office":
          bg.src = "assets/rooms/main_office.png";
          char.src = "assets/characters/logan.png";
          logDialogue("You see Logan at his desk, visibly nervous.");
          addOption("Talk to Logan", talkToLogan);
          break;
        case "Break Room":
          bg.src = "assets/rooms/break_room.png";
          char.src = "";
          logDialogue("A quiet room. You notice a USB drive on the table.");
          addOption("Inspect USB drive", inspectUSB);
          break;
        case "HR Office":
          bg.src = "assets/rooms/hr_office.png";
          char.src = "assets/characters/corey.png";
          logDialogue("You find Corey examining some personnel files.");
          addOption("Talk to Corey", talkToCorey);
          break;
        case "Crutchfield's Office":
          bg.src = "assets/rooms/crutchfield_office.png";
          char.src = "assets/characters/crutchfield.png";
          logDialogue("Deputy Director Crutchfield stands at her desk, reviewing a report.");
          addOption("Talk to Crutchfield", talkToCrutchfield);
          break;
        default:
          logDialogue("This room doesn't exist yet.");
          break;
      }
    }

    function talkToLogan() {
  clearOptions();
  if (!state.talkedToLogan) {
    logDialogue("Logan: 'Am I in trouble? I thought I followed protocol.'");
    state.talkedToLogan = true;
    addOption("Ask about the onboarding email", () => {
      clearOptions();
      logDialogue("Logan: 'It looked official... I just clicked the link without thinking. I'm sorry.'");
      addClue("Logan admits to clicking the phishing email.");
    });
    addOption("Ask what happened after he clicked", () => {
      clearOptions();
      logDialogue("Logan: 'It froze for a second, then nothing. I didn’t even realize it was a problem until now.'");
    });
  } else {
    logDialogue("Logan: 'I really didn't mean to mess things up.'");
  }
}

function startGame() {
      navigateTo("Lobby");
    }

    window.onload = startGame;

  </script>
</body>
</html>
