<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Breach: The Game</title>
  <style>
    body { display: flex; flex-direction: row; justify-content: center; gap: 30px; font-family: sans-serif; background: #f9f9f9; margin: 0; padding: 20px; }
    .game-container { display: flex; flex-direction: column; max-width: 960px; }
    .controls button { margin: 5px; padding: 10px 20px; font-size: 16px; }
    #timer { font-size: 18px; margin: 10px 0; }
    #game-area { position: relative; width: 960px; height: 540px; border: 1px solid #ccc; margin-bottom: 10px; }
    #background { width: 100%; height: 100%; }
    #character { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); height: 60%; pointer-events: none; }
    #options-box button { background: #fff; border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin: 5px auto; display: block; width: 100%; max-width: 400px; cursor: pointer; }
    #options-box button:hover { background: #f0f0f0; }
    #dialogue-box { background: rgba(255,255,255,0.95); padding: 20px; border:2px solid #444; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); font-size:16px; line-height:1.5; white-space: pre-wrap; min-height:100px; }
    .sidebar { min-width: 300px; }
    #score-box { font-size: 18px; margin-bottom: 10px; }
    #clue-sheet { border:1px solid #ccc; background:#fff; padding:10px; }
    #clue-sheet h3 { margin-top:0; }
    #clue-sheet ul { padding-left:20px; }
    #submit-report { margin-top:10px; padding:10px 20px; font-size:16px; width:100%; box-sizing:border-box; }
    .speaker-logan { color: #1f77b4; }
    .speaker-corey { color: #d62728; }
    .speaker-coyle { color: #2ca02c; }
    .speaker-reyes { color: #9467bd; }
    .speaker-crutchfield { color: #ff7f0e; }
    .speaker-you { color: #000; font-weight: bold; }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>The Breach: The Game</h1>
    <div id="timer">Time left: 30:00</div>
    <div class="controls">
      <button onclick="navigateTo('Lobby')">Lobby</button>
      <button onclick="navigateTo('Main Office')">Main Office</button>
      <button onclick="navigateTo('Break Room')">Break Room</button>
      <button onclick="navigateTo('HR Office')">HR Office</button>
      <button onclick="navigateTo('Server Room')">Server Room</button>
      <button onclick="navigateTo('Crutchfield\'s Office')">Crutchfield's Office</button>
    </div>
    <div id="game-area">
      <img id="background" src="" alt="Room">
      <img id="character" src="" alt="Character">
    </div>
    <div id="options-box"></div>
    <div id="dialogue-box"></div>
  </div>
  <div class="sidebar">
    <div id="score-box">Score: <span id="score-value">0</span></div>
    <div id="clue-sheet"><h3>Clue Sheet</h3><ul id="clue-list"></ul></div>
    <button id="submit-report" onclick="openFinalReport()">Submit Final Report</button>
  </div>
  <script>
    const state = { score:0, clueSheet:[], coreyQuizDone:false, loganDialogues:{}, coreyDialogues:{}, coyleDialogues:{}, reyesDialogues:{}, crutchfieldDialogues:{} };
    let currentRoom='', roomHtml={}, timeLeft=1800, timerInterval;
    function updateScore(n){ state.score+=n; document.getElementById('score-value').innerText=state.score; }
    function formatLine(t){ return t.replace(/^([^:]+):/, (m,p1)=>`<span class="speaker-${p1.toLowerCase().replace(/[^a-z]/g,'')}">${p1}:</span>`); }
    function logDialogue(t){ const h=formatLine(t); roomHtml[currentRoom]? roomHtml[currentRoom]+= '<br>'+h : roomHtml[currentRoom]=h; document.getElementById('dialogue-box').innerHTML=roomHtml[currentRoom]; }
    function clearOptions(){ document.getElementById('options-box').innerHTML=''; }
    function addOption(label,cb){ const b=document.createElement('button'); b.textContent=label; b.onclick=()=>{ logDialogue('You: '+label); cb(); }; document.getElementById('options-box').appendChild(b); }
    function addClue(c){ if(!state.clueSheet.includes(c)){ state.clueSheet.push(c); updateScore(20); const li=document.createElement('li'); li.innerHTML=c.replace(/\b(?:Logan|Corey|Coyle|Reyes|Crutchfield)\b/g,m=>`<span class="speaker-${m.toLowerCase()}">${m}</span>`); document.getElementById('clue-list').appendChild(li); }}
    function updateTimer(){ if(timeLeft<=0){ clearInterval(timerInterval); logDialogue('⏰ Time is up!'); clearOptions(); return;} const m=Math.floor(timeLeft/60), s=timeLeft%60; document.getElementById('timer').innerText=`Time left: ${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; timeLeft--; }
    function startTimer(){ updateTimer(); timerInterval=setInterval(updateTimer,1000); }
    function startQuiz({question,choices,onCorrect,onWrong}){ clearOptions(); logDialogue(question); choices.forEach(({text,correct})=>{ addOption(text,()=>{ correct? (updateScore(50), onCorrect()) : (updateScore(-10), onWrong()); }); }); }
    function navigateTo(room){ currentRoom=room; roomHtml[room]=''; document.getElementById('dialogue-box').innerHTML=''; clearOptions(); if(!state[`visited_${room}`]){ updateScore(10); state[`visited_${room}`]=true; } const bg=document.getElementById('background'), ch=document.getElementById('character'); switch(room){ case 'Lobby': bg.src='assets/rooms/lobby.png'; ch.src='assets/characters/reyes.png'; logDialogue("Reyes: 'There's been a security incident and we need your help. Navigate to the different rooms and talk with our agents — they may have clues about what happened. You have 30 minutes to solve this case! Good luck!'" ); addOption('Start Investigation',()=>{ clearOptions(); logDialogue("Reyes: 'Remember, check every room and gather as many clues as you can.'"); addOption('Talk to Reyes',talkToReyes); }); break; case 'Main Office': bg.src='assets/rooms/main_office.png'; ch.src='assets/characters/logan.png'; logDialogue("Logan: 'You’re here about the breach?'" ); addOption('Talk to Logan',talkToLogan); break; case 'Break Room': bg.src='assets/rooms/break_room.png'; ch.src=''; logDialogue("A quiet room. You notice a USB drive on the table."); addOption('View USB Drive',()=>{ clearOptions(); logDialogue("USB Drive: 'Secret Drive for Agent Coyle'"); addClue("Secret Drive labeled for Agent Coyle"); addClue("A suspicious USB drive for Coyle found in the break room."); addOption('View USB Drive Again',()=>navigateTo('Break Room')); }); break; case 'HR Office': bg.src='assets/rooms/hr_office.png'; ch.src='assets/characters/corey.png'; logDialogue("You find Corey examining some personnel files. A file cabinet stands nearby."); addOption('Talk to Corey',talkToCorey); addOption('Open File Cabinet',()=>{ clearOptions(); logDialogue("File Cabinet: 'Logan – Pending'"); addClue("HR File: Logan's record shows his new hire packet was never sent."); addClue("HR File: Reyes has completed all training modules. Corey's security training is overdue by 2 weeks."); addOption('Inspect anonymous note',()=>{ clearOptions(); logDialogue("Anonymous Note: 'Check the dark web logs.'"); addClue("Found unsigned internal memo suggesting to check dark web."); addOption('Back',()=>navigateTo('HR Office')); }); break; case 'Server Room': bg.src='assets/rooms/server_room.png'; ch.src='assets/characters/coyle.png'; logDialogue("Agent Coyle stands beside a humming server rack. A terminal glows in the corner."); addOption('Talk to Coyle',talkToCoyle); addOption('Access Dark Web Terminal',()=>{ clearOptions(); logDialogue("Dark Web Terminal: 'Password dump reveals exposed credentials for Coyle & Reyes; Logan not listed.'"); addClue("Dark Web Terminal: Multiple employees have credentials in past breaches."); addOption('Back',()=>navigateTo('Server Room')); }); break; case "Crutchfield's Office": bg.src='assets/rooms/crutchfield_office.png'; ch.src='assets/characters/crutchfield.png'; logDialogue("Deputy Director Crutchfield stands at her desk, reviewing a report."); addOption('Talk to Crutchfield',talkToCrutchfield); addOption('Review her notes',()=>{ clearOptions(); logDialogue("Her Notepad: 'Unusual VPN login from unrecognized IP.'"); addClue("Crutchfield’s notes mention unusual VPN activity last week."); addOption('Back',()=>navigateTo("Crutchfield's Office")); }); break; default: logDialogue("This room doesn't exist yet."); } }
    function talkToLogan(){ clearOptions(); const d=state.loganDialogues; if(!d.intro){ logDialogue("Logan: 'What can I do for you?'" ); d.intro=true; } if(!d.role){ addOption('Ask about his role here',()=>{ clearOptions(); logDialogue("Logan: 'I'm the new agent in training - today is my first day. Here to learn from the team.'"); d.role=true; talkToLogan(); }); } if(!d.computerIssue){ addOption('Ask about the computer glitch',()=>{ clearOptions(); logDialogue("Logan: 'It froze after I opened what I thought was my New Hire packet.'"); d.computerIssue=true; talkToLogan(); }); } if(state.clueSheet.includes("HR File: Logan's record shows his new hire packet was never sent.")&&!d.onboarding){ addOption('Ask about onboarding email',()=>{ clearOptions(); logDialogue("Logan: 'I clicked that packet email without realizing it was fake. I'm so sorry.'"); addClue("Logan admits to opening the new hire packet attachment in the email."); d.onboarding=true; talkToLogan(); }); } if(d.onboarding&&!d.aftermath){ addOption('Ask what happened after',()=>{ clearOptions(); logDialogue("Logan: 'I got up to get coffee and when I got back Crutchfield unplugged all the devices. She said something about Ransomware'"); addClue("Ransomware discovered around 9:05am."); d.aftermath=true; talkToLogan(); }); } if(d.intro&&d.role&&d.computerIssue&&d.onboarding&&d.aftermath){ logDialogue("Logan: 'That’s all I can provide right now.'"); addOption('Talk again',talkToLogan); } }
    function talkToCorey(){ clearOptions(); const d=state.coreyDialogues; if(!d.behavior){ logDialogue("Corey: 'First breach rodeo, am I right?'" ); addOption('Ask about suspicious behavior',()=>{ clearOptions(); logDialogue("Corey: 'Logan showed me an email that seemed off...'" ); addClue("Corey warned Logan not to open the suspicious email."); d.behavior=true; talkToCorey(); }); } if(!state.coreyQuizDone){ addOption('Take Corey’s phishing quiz',()=>startQuiz({ question:'Which does the SLAM method stand for when analyzing a suspicious message?', choices:[{text:'Secret Listening Alert Method',correct:false},{text:'Sender, Links, Attachments, Message',correct:true},{text:'Something Looks Awfully Malicious',correct:false},{text:'Seven Links Around Malware',correct:false}], onCorrect:()=>{ logDialogue("Corey: 'Exactly! Always look closely at the sender of the email, be wary of links and attachments, and review their message details carefully.'"); addClue('Understood the SLAM method.'); talkToCorey(); }, onWrong:()=>{ logDialogue("Corey: 'Not quite. It's actualy the Sender, Links, Attachments, and Message. Review those items if a message looks suspcious.'"); talkToCorey(); } })); } if(d.behavior&&state.coreyQuizDone){ logDialogue("Corey: 'Anything else?'" ); addOption('Talk again',talkToCorey); } }
    function talkToCoyle(){ clearOptions(); const d=state.coyleDialogues; if(!d.logs){ logDialogue("Coyle: 'Server load spiked like a heart monitor.'" ); addOption('Ask when it spiked',()=>{ clearOptions(); logDialogue("Coyle: 'Exactly 9:05 AM.'"); addClue("Attack initiated at 9:05 AM."); d.logs=true; talkToCoyle(); }); } if(!d.message){ addOption("Ask about Logan's message",()=>{ clearOptions(); logDialogue("Coyle: 'He asked if a file was safe; I said yes.'"); addClue("Coyle okayed the suspicious email."); d.message=true; talkToCoyle(); }); } if(!d.filters){ addOption('Ask about filters',()=>{ clearOptions(); logDialogue("Coyle: 'Our filters miss spear-phish by design.'"); d.filters=true; talkToCoyle(); }); } if(!d.logins){ addOption('Ask about login attempts',()=>{ clearOptions(); logDialogue("Coyle: 'Found failed admin login at 9:02.'"); addClue("Failed admin login attempt at 9:02 AM."); d.logins=true; talkToCoyle(); }); } if(!d.ignoredAlert){ addOption('Ask about ignored alerts',()=>{ clearOptions(); logDialogue("Coyle: 'Around 11am, an endpoint alert popped up but looked like maintenance.'"); addClue("Coyle ignored an endpoint alert at 11:00am."); d.ignoredAlert=true; talkToCoyle(); }); } if(d.logs&&d.message&&d.filters&&d.logins&&d.ignoredAlert){ logDialogue("Coyle: 'That’s my piece.'" ); addOption('Talk again',talkToCoyle); } }
    function talkToReyes(){ clearOptions(); const d=state.reyesDialogues; if(!d.intro){ logDialogue("Reyes: 'I’ve seen patterns in every breach.'" ); d.intro=true; } if(!d.behavior){ addOption('Ask about typical breach patterns',()=>{ clearOptions(); logDialogue("Reyes: 'It usually starts with a click.'"); addClue("Phishing is the most common breach factor."); d.behavior=true; talkToReyes(); }); } if(!d.training){ addOption('Ask about training',()=>{ clearOptions(); logDialogue("Reyes: 'We need live simulations.'"); d.training=true; talkToReyes(); }); } if(!d.agents){ addOption('Ask about Coyle',()=>{ clearOptions(); logDialogue("Reyes: 'Coyle's great but he moves fast, sometimes too fast. I always tell him he needs to slow down and watch what he's doing.'"); addClue("Coyle moves too fast, warns of rushed decisions."); d.agents=true; talkToReyes(); }); } if(!d.watch){ addOption("Ask what she thinks of the new guy, Logan",()=>{ clearOptions(); logDialogue("Reyes: 'He's nice but new hires are a concern. They are often target of spear phishing attempts with specific details about their new employment."); d.watch=true; talkToReyes(); }); } if(!d.vishing){ addOption('Ask about vishing calls',()=>{ clearOptions(); logDialogue("Reyes: 'Well, I think I did get a vishing - that's voice phishing - call, today at 9:45 AM.'"); addClue("Reyes received a vishing call at 9:45 AM."); d.vishing=true; talkToReyes(); }); } if(d.behavior&&d.training&&d.agents&&d.watch&&d.vishing){ logDialogue("Reyes: 'Nothing else here.'" ); addOption('Talk again',talkToReyes); } }
    function talkToCrutchfield(){ clearOptions(); const d=state.crutchfieldDialogues; if(!d.intro){ logDialogue("Crutchfield: 'Onboarding is critical.'" ); d.intro=true; } if(!d.onboarding){ addOption('Ask quiz result',()=>{ clearOptions(); logDialogue("Crutchfield: 'He aced it, shockingly.'"); addClue("Logan passed the quiz but fell for phishing."); d.onboarding=true; talkToCrutchfield(); }); } if(!d.response){ addOption('Ask about isolation',()=>{ clearOptions(); logDialogue("Crutchfield: 'We isolated the systems immediately. That helped the ransomware from spreading. Working to find the main source now.'"); addClue("Systems isolated after breach. Ransomware came from one device in the office."); d.response=true; talkToCrutchfield(); }); } if(!d.suspicion){ addOption('Ask if she mistrusts anyone',()=>{ clearOptions(); logDialogue("Crutchfield: 'Corey's secrecy worries me.'"); addClue("Crutchfield suspicious of Corey."); d.suspicion=true; talkToCrutchfield(); }); } if(!d.external){ addOption('Ask about external threat',()=>{ clearOptions(); logDialogue("Crutchfield: 'We've seen coordinated bot attacks against our agency in the past. It didn't look like this though.'"); d.external=true; talkToCrutchfield(); }); } if(d.onboarding&&d.response&&d.suspicion&&d.external){ logDialogue("Crutchfield: 'That concludes my notes. We are!... Penn State!'" ); addOption('Talk again',talkToCrutchfield); } }
    function openFinalReport(){ clearOptions(); logDialogue('Submit final report: Who & how?'); const csel=document.createElement('select'); csel.id='accusedCharacter'; ['Logan','Corey','Coyle','Reyes','Crutchfield'].forEach(n=>{const o=document.createElement('option');o.value=n;o.textContent=n;csel.appendChild(o);}); document.getElementById('options-box').appendChild(csel); const ssel=document.createElement('select'); ssel.id='breachScenario'; ['Clicked a phishing email disguised as a new hire packet','Downloaded malware from USB drive','Reused credentials from past breach','Forwarded scam','Missed invoice scam','Ignored alert','Vishing call','Weak password','Malicious attachment','External access'].forEach(s=>{const o=document.createElement('option');o.value=s;o.textContent=s;ssel.appendChild(o);}); document.getElementById('options-box').appendChild(ssel); const sb=document.createElement('button'); sb.textContent='Submit'; sb.onclick=()=>submitAccusation(csel.value,ssel.value); document.getElementById('options-box').appendChild(sb); }
    function submitAccusation(n,r){ clearOptions(); if(n==='Logan'&&r==='Clicked a phishing email disguised as a new hire packet'){ const bonus=Math.floor(timeLeft/10); updateScore(bonus); logDialogue(`✅ Correct! Logan was the culprit. You earned a time bonus of ${bonus} points.`);} else{ updateScore(-100); logDialogue(`❌ Not quite. ${n} & that method incorrect. -100 points penalty.`);} }
    function highlightButtons(room){ document.querySelectorAll('.controls button').forEach(b=>b.style.backgroundColor=b.textContent===room?'#d0eaff':''); }
    function startGame(){ startTimer(); navigateTo('Lobby'); }
    document.addEventListener('DOMContentLoaded',startGame);
  </script>
</body>
</html>
