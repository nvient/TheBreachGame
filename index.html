<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Breach: The Game</title>
  <style>
    body {
      display: flex;
      flex-direction: row;
      justify-content: center;
      gap: 30px;
      font-family: sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
    }
    .game-container {
      display: flex;
      flex-direction: column;
      max-width: 960px;
    }
    .controls button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
    }
    #game-area {
      position: relative;
      width: 960px;
      height: 540px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }
    #background {
      width: 100%;
      height: 100%;
    }
    #character {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      height: 60%;
      pointer-events: none;
    }
    #options-box {
      margin-bottom: 10px;
    }
    #options-box button {
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
      font-size: 15px;
      display: block;
      width: 100%;
      max-width: 400px;
      margin: 5px auto;
      cursor: pointer;
    }
    #options-box button:hover {
      background-color: #f0f0f0;
    }
    #dialogue-box {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border: 2px solid #444;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      font-size: 16px;
      line-height: 1.5;
      white-space: pre-line;
      min-height: 100px;
    }
    .sidebar {
      min-width: 300px;
    }
    #clue-sheet {
      border: 1px solid #ccc;
      background: #fff;
      padding: 10px;
    }
    #clue-sheet h3 {
      margin-top: 0;
    }
    #clue-sheet ul {
      padding-left: 20px;
    }
    #submit-report {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>The Breach: The Game</h1>
    <div class="controls">
      <button onclick="navigateTo('Main Office')">Main Office</button>
      <button onclick="navigateTo('Break Room')">Break Room</button>
      <button onclick="navigateTo('HR Office')">HR Office</button>
      <button onclick="navigateTo('Crutchfield\'s Office')">Crutchfield's Office</button>
      <button onclick="navigateTo('Lobby')">Lobby</button>
      <button onclick="navigateTo('Server Room')">Server Room</button>
    </div>
    <div id="game-area">
      <img id="background" src="" alt="Room Background">
      <img id="character" src="" alt="Character">
    </div>
    <div id="options-box"></div>
    <div id="dialogue-box">Click a room to begin your investigation.</div>
  </div>
  <div class="sidebar">
    <div id="clue-sheet">
      <h3>Clue Sheet</h3>
      <ul id="clue-list"></ul>
    </div>
    <button id="submit-report" onclick="openFinalReport()">Submit Final Report</button>
  </div>
  <script>
    const state = {
      clueSheet: [],
      talkedToLogan: false,
      talkedToCorey: false,
      talkedToCoyle: false,
      talkedToReyes: false,
      talkedToCrutchfield: false,
      loganDialogues: {},
      coreyDialogues: {},
      coyleDialogues: {},
      reyesDialogues: {},
      crutchfieldDialogues: {}
    };
    let currentRoom = "";
    let roomDialogues = {};

    function logDialogue(text) {
      if (!roomDialogues[currentRoom]) roomDialogues[currentRoom] = text;
      else roomDialogues[currentRoom] += "\n" + text;
      document.getElementById('dialogue-box').innerText = roomDialogues[currentRoom];
    }

    function clearOptions() {
      document.getElementById('options-box').innerHTML = '';
    }

    function addOption(label, callback) {
      const btn = document.createElement('button');
      btn.textContent = label;
      btn.onclick = callback;
      document.getElementById('options-box').appendChild(btn);
    }

    function addClue(clue) {
      if (!state.clueSheet.includes(clue)) {
        state.clueSheet.push(clue);
        const li = document.createElement('li');
        li.textContent = `${state.clueSheet.length}. ${clue}`;
        document.getElementById('clue-list').appendChild(li);
      }
    }

    function highlightRoomButton(room) {
      document.querySelectorAll('.controls button').forEach(btn => {
        btn.style.backgroundColor = btn.textContent === room ? '#d0eaff' : '';
      });
    }

    function navigateTo(room) {
      currentRoom = room;
      highlightRoomButton(room);
      roomDialogues[room] = '';
      document.getElementById('dialogue-box').innerText = '';
      clearOptions();
      const bg = document.getElementById('background');
      const char = document.getElementById('character');
      switch(room) {
        case 'Main Office':
          bg.src = 'assets/rooms/main_office.png';
          char.src = 'assets/characters/logan.png';
          logDialogue("You see Logan at his desk, visibly nervous.");
          addOption('Talk to Logan', talkToLogan);
          break;
        case 'Break Room':
          bg.src = 'assets/rooms/break_room.png';
          char.src = '';
          logDialogue("A quiet room. You notice a USB drive on the table.");
          addOption('View USB Drive', () => {
            addClue('Secret Drive labeled for Agent Coyle');
            logDialogue("You inspect the USB. It's labeled 'Secret Drive for Agent Coyle'.");
          });
          break;
        case 'HR Office':
          bg.src = 'assets/rooms/hr_office.png';
          char.src = 'assets/characters/corey.png';
          logDialogue("You find Corey examining some personnel files. A file cabinet stands nearby.");
          addOption('Talk to Corey', talkToCorey);
          addOption('Open File Cabinet', () => {
            addClue("HR File: Logan's record shows his new hire packet was never sent. The phishing email he opened was fake.");
            logDialogue("You find a folder marked 'Logan – Pending'... never sent official packet.");
          });
          break;
        case 'Crutchfield\'s Office':
          bg.src = 'assets/rooms/crutchfield_office.png';
          char.src = 'assets/characters/crutchfield.png';
          logDialogue("Deputy Director Crutchfield stands at her desk.");
          addOption('Talk to Crutchfield', talkToCrutchfield);
          break;
        case 'Lobby':
          bg.src = 'assets/rooms/lobby.png';
          char.src = 'assets/characters/reyes.png';
          logDialogue("Agent Reyes leans against the reception desk.");
          addOption('Talk to Reyes', talkToReyes);
          break;
        case 'Server Room':
          bg.src = 'assets/rooms/server_room.png';
          char.src = 'assets/characters/coyle.png';
          logDialogue("Agent Coyle stands beside a server rack. A terminal glows.");
          addOption('Talk to Coyle', talkToCoyle);
          addOption('Access Dark Web Terminal', () => {
            addClue('Dark Web Terminal: Employees hashed credentials found; Logan clean');
            logDialogue('Terminal shows hashed creds for Coyle and Reyes; Logan not listed.');
          });
          break;
        default:
          logDialogue('This room doesn\'t exist yet.');
      }
    }

    function talkToLogan() {
      clearOptions();
      if (!state.loganDialogues.onboarding) {
        logDialogue("Logan: 'Am I in trouble?'");
        addOption('Ask about the onboarding email', () => {
          logDialogue("Logan: 'I clicked a fake packet email.'"); state.loganDialogues.onboarding = true;
        });
      } else {
        logDialogue("Logan: 'That\'s all I can tell you.'");
      }
    }
    // Similar talkToCorey, talkToCoyle, talkToReyes, talkToCrutchfield implementations...

    function openFinalReport() {
      clearOptions();
      logDialogue('Submit your final report: Who & how?');
      const container = document.getElementById('options-box');
      const charSelect = document.createElement('select');
      charSelect.id = 'accusedCharacter';
      ['Logan','Corey','Coyle','Reyes'].forEach(n => { const o=document.createElement('option'); o.value=o.textContent=n; charSelect.appendChild(o); });
      container.appendChild(charSelect);
      const scenarioSelect = document.createElement('select');
      scenarioSelect.id = 'breachScenario';
      ['Clicked a phishing email disguised as a new hire packet', 'Downloaded malware from USB drive', 'Reused credentials from past breach', 'Forwarded scam to colleagues', 'Missed spoofed invoice request', 'Ignored endpoint alert', 'Fell for a vishing call', 'Used weak password', 'Opened malicious attachment', 'Allowed access to outsider'].forEach(s=>{const o=document.createElement('option');o.value=o.textContent=s;scenarioSelect.appendChild(o);});
      container.appendChild(scenarioSelect);
      const submitBtn = document.createElement('button');
      submitBtn.textContent = 'Submit';
      submitBtn.onclick = () => submitAccusation(charSelect.value, scenarioSelect.value);
      container.appendChild(submitBtn);
    }

    function submitAccusation(name, reason) {
      clearOptions();
      if (name==='Logan' && reason==='Clicked a phishing email disguised as a new hire packet') {
        logDialogue('✅ Correct!');
      } else logDialogue(`❌ Not quite. ${name} & that method incorrect.`);
    }

    function startGame() { navigateTo('Lobby'); }
    document.addEventListener('DOMContentLoaded', startGame);
  </script>
</body>
</html>
